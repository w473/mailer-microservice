# mailing-microservice
## Description
Microservice for sending emails.

Possibilities:
- template 
  - add
  - delete
  - update
- email
  - find
  - send using template

## Installation

```bash
$ npm ci
```

## Running the app

```bash
# development
$ npm run start

# watch mode
$ npm run start:dev

# production mode
$ npm run start:prod
```

## Test

```bash
# unit tests
$ npm run test

# tests coverage
$ npm run test:cov
```

## Docker images:
ghcr.io/w473/mailer-microservice:latest

and

ghcr.io/w473/mailer-microservice:TAG

e.g.

ghcr.io/w473/mailer-microservice:0.0.1

## SECURITY
Microservice is designed to work in Kubernetes cluster 
with [Istio](https://istio.io/) and [Keycloak](https://www.keycloak.org/)

### Authentication:
JWT should be generated by Keycloak

Istio should protect microservice

### Authorization
Microservice is looking for header with payload of JWT
- by default "x-authz" 
- can be switch env variable AUTHORIZATION_HEADER

Roles are expected to be in
```json
"realm_access": {
    "roles": [
      'ADMIN',
      'SYS'
    ]
  },

```
